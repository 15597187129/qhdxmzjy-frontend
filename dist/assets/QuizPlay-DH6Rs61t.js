import{d as U,r as d,c as b,o as $,a as j,b as B,e as l,f as u,N as O,w as r,t as a,g as v,h as g,F as S,i as R,j as G,k as V,E as w,u as H,l as y,_ as J}from"./index-CI4pvarJ.js";const K={class:"quiz-container"},W={class:"quiz-header"},X={class:"quiz-title"},Y={class:"quiz-body"},Z={class:"quiz-question"},ee={class:"btn-group"},te=U({__name:"QuizPlay",setup(se){const _=d([]),n=d(0),i=d(null),p=d([]),f=d(600);let m=null;const N=H(),q=b(()=>_.value[n.value]),h=b(()=>n.value===_.value.length-1),T=b(()=>{const e=q.value;return e?[{label:"A",text:e.optionA||""},{label:"B",text:e.optionB||""},{label:"C",text:e.optionC||""},{label:"D",text:e.optionD||""}].filter(t=>t.text):[]}),Q=b(()=>{const e=Math.floor(f.value/60),t=f.value%60,s=String(e).padStart(2,"0"),c=String(t).padStart(2,"0");return`${s}:${c}`});async function D(){try{const{data:e}=await V.get("/questions/daily");_.value=e}catch(e){console.error("获取题目失败",e),w.error("获取题目失败")}}function E(){m=window.setInterval(()=>{f.value>0?f.value--:C()},1e3)}function x(){m!==null&&(clearInterval(m),m=null)}function z(){const e=q.value;if(!e)return;const t=p.value.find(c=>c.questionId===e.id),s={questionId:e.id,userAnswer:i.value||""};t?t.userAnswer=s.userAnswer:p.value.push(s)}function A(){const e=q.value;if(!e){i.value=null;return}const t=p.value.find(s=>s.questionId===e.id);i.value=t?t.userAnswer:null}function M(){z(),n.value>0&&(n.value--,A())}function F(){z(),h.value?C():(n.value++,A())}async function C(){x();try{const e={answers:p.value},{data:t}=await V.post("/quiz_result/submit",e);w.success(t),N.push({name:"daily-quiz"})}catch(e){console.error("提交失败",e),w.error("提交失败")}}return $(()=>{D(),E()}),j(()=>{x()}),(e,t)=>{const s=v("el-tag"),c=v("el-radio"),L=v("el-radio-group"),I=v("el-button"),P=v("el-card");return y(),B(S,null,[l(O),u("div",K,[l(P,{class:"quiz-card",shadow:"hover"},{default:r(()=>{var k;return[u("div",W,[u("span",X," 题目 "+a(n.value+1)+" / "+a(_.value.length),1),l(s,{type:"danger",effect:"plain",class:"quiz-timer"},{default:r(()=>[g(" 倒计时 "+a(Q.value),1)]),_:1})]),u("div",Y,[u("div",Z,a(((k=q.value)==null?void 0:k.content)||"加载中..."),1),l(L,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=o=>i.value=o),class:"quiz-option-group"},{default:r(()=>[(y(!0),B(S,null,R(T.value,o=>(y(),G(c,{key:o.label,label:o.label,class:"quiz-option"},{default:r(()=>[g(a(o.label)+". "+a(o.text),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),u("div",ee,[l(I,{disabled:n.value===0,onClick:M},{default:r(()=>t[1]||(t[1]=[g(" 上一题 ")])),_:1},8,["disabled"]),l(I,{type:"primary",onClick:F},{default:r(()=>[g(a(h.value?"提交答案":"下一题"),1)]),_:1})])]}),_:1})])],64)}}}),ae=J(te,[["__scopeId","data-v-80527868"]]);export{ae as default};
