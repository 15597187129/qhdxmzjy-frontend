import{d as fe,m as de,r as me,o as pe,b as ve,e as re,f as Qt,N as we,w as he,g as ce,k as ge,E as ue,l as ye,h as xe,t as Ee,u as be,_ as Me}from"./index-CmgaUIAA.js";window.libpannellum=function(Z,d,w){function Ut(B){function xt(i,r){return i.level==1&&r.level!=1?-1:r.level==1&&i.level!=1?1:r.timestamp-i.timestamp}function rt(i,r){return i.level!=r.level?i.level-r.level:i.diff-r.diff}function Et(i,r,L,y,u,s){this.vertices=i,this.side=r,this.level=L,this.x=y,this.y=u,this.path=s.replace("%s",r).replace("%l",L).replace("%x",y).replace("%y",u)}function Wt(i,r,L,y,u){var s,x=r.vertices;s=Tt(i,x.slice(0,3));var l=Tt(i,x.slice(3,6)),_=Tt(i,x.slice(6,9)),x=Tt(i,x.slice(9,12)),E=s[0]+l[0]+_[0]+x[0];if(E==-4||E==4?s=!1:(E=s[1]+l[1]+_[1]+x[1],s=E==-4||E==4?!1:s[2]+l[2]+_[2]+x[2]!=4),s){for(s=r.vertices,l=s[0]+s[3]+s[6]+s[9],_=s[1]+s[4]+s[7]+s[10],x=s[2]+s[5]+s[8]+s[11],E=Math.sqrt(l*l+_*_+x*x),x=Math.asin(x/E),l=Math.atan2(_,l)-y,l+=l>Math.PI?-2*Math.PI:l<-Math.PI?2*Math.PI:0,l=Math.abs(l),r.diff=Math.acos(Math.sin(L)*Math.sin(x)+Math.cos(L)*Math.cos(x)*Math.cos(l)),l=!1,_=0;_<h.nodeCache.length;_++)if(h.nodeCache[_].path==r.path){l=!0,h.nodeCache[_].timestamp=h.nodeCacheTimestamp++,h.nodeCache[_].diff=r.diff,h.currentNodes.push(h.nodeCache[_]);break}if(l||(r.timestamp=h.nodeCacheTimestamp++,h.currentNodes.push(r),h.nodeCache.push(r)),r.level<h.level){var x=p.cubeResolution*Math.pow(2,r.level-p.maxLevel),l=Math.ceil(x*p.invTileResolution)-1,_=x%p.tileResolution*2,D=2*x%p.tileResolution;D===0&&(D=p.tileResolution),_===0&&(_=2*p.tileResolution),E=.5,(r.x==l||r.y==l)&&(E=1-p.tileResolution/(p.tileResolution+D));var A=1-E,x=[],Y=E,W=E,O=E,U=A,m=A,N=A;for(D<p.tileResolution&&(r.x==l&&r.y!=l?(m=W=.5,(r.side=="d"||r.side=="u")&&(N=O=.5)):r.x!=l&&r.y==l&&(U=Y=.5,r.side=="l"||r.side=="r")&&(N=O=.5)),_<=p.tileResolution&&(r.x==l&&(Y=0,U=1,r.side=="l"||r.side=="r")&&(O=0,N=1),r.y==l&&(W=0,m=1,r.side=="d"||r.side=="u")&&(O=0,N=1)),D=[s[0],s[1],s[2],s[0]*Y+s[3]*U,s[1]*E+s[4]*A,s[2]*O+s[5]*N,s[0]*Y+s[6]*U,s[1]*W+s[7]*m,s[2]*O+s[8]*N,s[0]*E+s[9]*A,s[1]*W+s[10]*m,s[2]*O+s[11]*N],D=new Et(D,r.side,r.level+1,2*r.x,2*r.y,p.fullpath),x.push(D),r.x==l&&_<=p.tileResolution||(D=[s[0]*Y+s[3]*U,s[1]*E+s[4]*A,s[2]*O+s[5]*N,s[3],s[4],s[5],s[3]*E+s[6]*A,s[4]*W+s[7]*m,s[5]*O+s[8]*N,s[0]*Y+s[6]*U,s[1]*W+s[7]*m,s[2]*O+s[8]*N],D=new Et(D,r.side,r.level+1,2*r.x+1,2*r.y,p.fullpath),x.push(D)),r.x==l&&_<=p.tileResolution||r.y==l&&_<=p.tileResolution||(D=[s[0]*Y+s[6]*U,s[1]*W+s[7]*m,s[2]*O+s[8]*N,s[3]*E+s[6]*A,s[4]*W+s[7]*m,s[5]*O+s[8]*N,s[6],s[7],s[8],s[9]*Y+s[6]*U,s[10]*E+s[7]*A,s[11]*O+s[8]*N],D=new Et(D,r.side,r.level+1,2*r.x+1,2*r.y+1,p.fullpath),x.push(D)),r.y==l&&_<=p.tileResolution||(D=[s[0]*E+s[9]*A,s[1]*W+s[10]*m,s[2]*O+s[11]*N,s[0]*Y+s[6]*U,s[1]*W+s[7]*m,s[2]*O+s[8]*N,s[9]*Y+s[6]*U,s[10]*E+s[7]*A,s[11]*O+s[8]*N,s[9],s[10],s[11]],D=new Et(D,r.side,r.level+1,2*r.x,2*r.y+1,p.fullpath),x.push(D)),r=0;r<x.length;r++)Wt(i,x[r],L,y)}}}function It(){return[-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,-1,1,1,1,1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,-1,-1,-1,1,1,1,-1,1,1,1,1,-1,1,1,-1,-1]}function St(i,r,L){var y=Math.sin(r);if(r=Math.cos(r),L=="x")return[i[0],r*i[1]+y*i[2],r*i[2]-y*i[1],i[3],r*i[4]+y*i[5],r*i[5]-y*i[4],i[6],r*i[7]+y*i[8],r*i[8]-y*i[7]];if(L=="y")return[r*i[0]-y*i[2],i[1],r*i[2]+y*i[0],r*i[3]-y*i[5],i[4],r*i[5]+y*i[3],r*i[6]-y*i[8],i[7],r*i[8]+y*i[6]];if(L=="z")return[r*i[0]+y*i[1],r*i[1]-y*i[0],i[2],r*i[3]+y*i[4],r*i[4]-y*i[3],i[5],r*i[6]+y*i[7],r*i[7]-y*i[6],i[8]]}function Rt(i){return[i[0],i[4],i[8],i[12],i[1],i[5],i[9],i[13],i[2],i[6],i[10],i[14],i[3],i[7],i[11],i[15]]}function qt(i){Zt(i,i.path+"."+p.extension,function(r,L){i.texture=r,i.textureLoaded=L?2:1},Nt.crossOrigin)}function Tt(i,r){var u=[i[0]*r[0]+i[1]*r[1]+i[2]*r[2],i[4]*r[0]+i[5]*r[1]+i[6]*r[2],i[11]+i[8]*r[0]+i[9]*r[1]+i[10]*r[2],1/(i[12]*r[0]+i[13]*r[1]+i[14]*r[2])],L=u[0]*u[3],y=u[1]*u[3],u=u[2]*u[3],s=[0,0,0];return-1>L&&(s[0]=-1),1<L&&(s[0]=1),-1>y&&(s[1]=-1),1<y&&(s[1]=1),(-1>u||1<u)&&(s[2]=1),s}function Bt(){console.log("Reducing canvas size due to error 1286!"),z.width=Math.round(z.width/2),z.height=Math.round(z.height/2)}var z=d.createElement("canvas");z.style.width=z.style.height="100%",B.appendChild(z);var h,n,nt,at,ft,et,At,bt,p,F,G,gt,zt,st,Ct,Nt;this.init=function(i,r,L,y,u,s,l,_){function x(U){if(D){var m=U*U*4,N=new Uint8ClampedArray(m),k=_.backgroundColor?_.backgroundColor:[0,0,0];k[0]*=255,k[1]*=255,k[2]*=255;for(var t=0;t<m;t++)N[t++]=k[0],N[t++]=k[1],N[t++]=k[2];for(U=new ImageData(N,U,U),E=0;6>E;E++)p[E].width==0&&(p[E]=U)}}if(r===w&&(r="equirectangular"),r!="equirectangular"&&r!="cubemap"&&r!="multires")throw console.log("Error: invalid image type specified!"),{type:"config error"};if(F=r,p=i,G=L,Nt=_||{},h){if(nt&&(n.detachShader(h,nt),n.deleteShader(nt)),at&&(n.detachShader(h,at),n.deleteShader(at)),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),h.texture&&n.deleteTexture(h.texture),h.nodeCache)for(i=0;i<h.nodeCache.length;i++)n.deleteTexture(h.nodeCache[i].texture);n.deleteProgram(h),h=w}bt=w;var E,D=!1,A;if(F=="cubemap")for(E=0;6>E;E++)0<p[E].width?(A===w&&(A=p[E].width),A!=p[E].width&&console.log("Cube faces have inconsistent widths: "+A+" vs. "+p[E].width)):D=!0;if(F=="cubemap"&&(A&A-1)!==0&&(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 9_/)||navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 10_/)||navigator.userAgent.match(/Trident.*rv[ :]*11\./))||(n||(n=z.getContext("experimental-webgl",{alpha:!1,depth:!1})),n&&n.getError()==1286&&Bt()),!n&&(F=="multires"&&p.hasOwnProperty("fallbackPath")||F=="cubemap")&&("WebkitAppearance"in d.documentElement.style||navigator.userAgent.match(/Trident.*rv[ :]*11\./)||navigator.appVersion.indexOf("MSIE 10")!==-1)){et&&B.removeChild(et),et=d.createElement("div"),et.className="pnlm-world",y=p.basePath?p.basePath+p.fallbackPath:p.fallbackPath;var Y="frblud".split(""),W=0;u=function(){var m=d.createElement("canvas");m.className="pnlm-face pnlm-"+Y[this.side]+"face",et.appendChild(m);var N=m.getContext("2d");m.style.width=this.width+4+"px",m.style.height=this.height+4+"px",m.width=this.width+4,m.height=this.height+4,N.drawImage(this,2,2);var k=N.getImageData(0,0,m.width,m.height),t=k.data,M,P;for(M=2;M<m.width-2;M++)for(P=0;4>P;P++)t[4*(M+m.width)+P]=t[4*(M+2*m.width)+P],t[4*(M+m.width*(m.height-2))+P]=t[4*(M+m.width*(m.height-3))+P];for(M=2;M<m.height-2;M++)for(P=0;4>P;P++)t[4*(M*m.width+1)+P]=t[4*(M*m.width+2)+P],t[4*((M+1)*m.width-2)+P]=t[4*((M+1)*m.width-3)+P];for(P=0;4>P;P++)t[4*(m.width+1)+P]=t[4*(2*m.width+2)+P],t[4*(2*m.width-2)+P]=t[4*(3*m.width-3)+P],t[4*(m.width*(m.height-2)+1)+P]=t[4*(m.width*(m.height-3)+2)+P],t[4*(m.width*(m.height-1)-2)+P]=t[4*(m.width*(m.height-2)-3)+P];for(M=1;M<m.width-1;M++)for(P=0;4>P;P++)t[4*M+P]=t[4*(M+m.width)+P],t[4*(M+m.width*(m.height-1))+P]=t[4*(M+m.width*(m.height-2))+P];for(M=1;M<m.height-1;M++)for(P=0;4>P;P++)t[M*m.width*4+P]=t[4*(M*m.width+1)+P],t[4*((M+1)*m.width-1)+P]=t[4*((M+1)*m.width-2)+P];for(P=0;4>P;P++)t[P]=t[4*(m.width+1)+P],t[4*(m.width-1)+P]=t[4*(2*m.width-2)+P],t[m.width*(m.height-1)*4+P]=t[4*(m.width*(m.height-2)+1)+P],t[4*(m.width*m.height-1)+P]=t[4*(m.width*(m.height-1)-2)+P];N.putImageData(k,0,0),O.call(this)};var O=function(){0<this.width?(ft===w&&(ft=this.width),ft!=this.width&&console.log("Fallback faces have inconsistent widths: "+ft+" vs. "+this.width)):D=!0,W++,W==6&&(ft=this.width,B.appendChild(et),l())},D=!1;for(E=0;6>E;E++)s=new Image,s.crossOrigin=Nt.crossOrigin?Nt.crossOrigin:"anonymous",s.side=E,s.onload=u,s.onerror=O,s.src=F=="multires"?y.replace("%s",Y[E])+"."+p.extension:p[E].src;x(ft)}else{if(!n)throw console.log("Error: no WebGL support detected!"),{type:"no webgl"};for(F=="cubemap"&&x(A),p.fullpath=p.basePath?p.basePath+p.path:p.path,p.invTileResolution=1/p.tileResolution,i=It(),At=[],E=0;6>E;E++)At[E]=i.slice(12*E,12*E+12),i=It();if(i=0,F=="equirectangular"){if(i=n.getParameter(n.MAX_TEXTURE_SIZE),Math.max(p.width/2,p.height)>i)throw console.log("Error: The image is too big; it's "+p.width+"px wide, but this device's maximum supported size is "+2*i+"px."),{type:"webgl size error",width:p.width,maxWidth:2*i}}else if(F=="cubemap"&&A>n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE))throw console.log("Error: The image is too big; it's "+A+"px wide, but this device's maximum supported size is "+i+"px."),{type:"webgl size error",width:A,maxWidth:i};if(_===w||_.horizonPitch===w&&_.horizonRoll===w||(bt=[_.horizonPitch==w?0:_.horizonPitch,_.horizonRoll==w?0:_.horizonRoll]),A=n.TEXTURE_2D,n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),n.getShaderPrecisionFormat&&(r=n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT))&&1>r.precision&&(wt=wt.replace("highp","mediump")),nt=n.createShader(n.VERTEX_SHADER),r=I,F=="multires"&&(r=S),n.shaderSource(nt,r),n.compileShader(nt),at=n.createShader(n.FRAGMENT_SHADER),r=tt,F=="cubemap"?(A=n.TEXTURE_CUBE_MAP,r=Q):F=="multires"&&(r=_t),n.shaderSource(at,r),n.compileShader(at),h=n.createProgram(),n.attachShader(h,nt),n.attachShader(h,at),n.linkProgram(h),n.getShaderParameter(nt,n.COMPILE_STATUS)||console.log(n.getShaderInfoLog(nt)),n.getShaderParameter(at,n.COMPILE_STATUS)||console.log(n.getShaderInfoLog(at)),n.getProgramParameter(h,n.LINK_STATUS)||console.log(n.getProgramInfoLog(h)),n.useProgram(h),h.drawInProgress=!1,r=_.backgroundColor?_.backgroundColor:[0,0,0],n.clearColor(r[0],r[1],r[2],1),n.clear(n.COLOR_BUFFER_BIT),h.texCoordLocation=n.getAttribLocation(h,"a_texCoord"),n.enableVertexAttribArray(h.texCoordLocation),F!="multires"?(gt||(gt=n.createBuffer()),n.bindBuffer(n.ARRAY_BUFFER,gt),n.bufferData(n.ARRAY_BUFFER,new Float32Array([-1,1,1,1,1,-1,-1,1,1,-1,-1,-1]),n.STATIC_DRAW),n.vertexAttribPointer(h.texCoordLocation,2,n.FLOAT,!1,0,0),h.aspectRatio=n.getUniformLocation(h,"u_aspectRatio"),n.uniform1f(h.aspectRatio,n.drawingBufferWidth/n.drawingBufferHeight),h.psi=n.getUniformLocation(h,"u_psi"),h.theta=n.getUniformLocation(h,"u_theta"),h.f=n.getUniformLocation(h,"u_f"),h.h=n.getUniformLocation(h,"u_h"),h.v=n.getUniformLocation(h,"u_v"),h.vo=n.getUniformLocation(h,"u_vo"),h.rot=n.getUniformLocation(h,"u_rot"),n.uniform1f(h.h,y/(2*Math.PI)),n.uniform1f(h.v,u/Math.PI),n.uniform1f(h.vo,s/Math.PI*2),F=="equirectangular"&&(h.backgroundColor=n.getUniformLocation(h,"u_backgroundColor"),n.uniform4fv(h.backgroundColor,r.concat([1]))),h.texture=n.createTexture(),n.bindTexture(A,h.texture),F=="cubemap"?(n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,p[1]),n.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_X,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,p[3]),n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_Y,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,p[4]),n.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_Y,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,p[5]),n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_Z,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,p[0]),n.texImage2D(n.TEXTURE_CUBE_MAP_NEGATIVE_Z,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,p[2])):p.width<=i?(n.uniform1i(n.getUniformLocation(h,"u_splitImage"),0),n.texImage2D(A,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,p)):(n.uniform1i(n.getUniformLocation(h,"u_splitImage"),1),y=d.createElement("canvas"),y.width=p.width/2,y.height=p.height,y=y.getContext("2d"),y.drawImage(p,0,0),u=y.getImageData(0,0,p.width/2,p.height),n.texImage2D(A,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,u),h.texture2=n.createTexture(),n.activeTexture(n.TEXTURE1),n.bindTexture(A,h.texture2),n.uniform1i(n.getUniformLocation(h,"u_image1"),1),y.drawImage(p,-p.width/2,0),u=y.getImageData(0,0,p.width/2,p.height),n.texImage2D(A,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,u),n.texParameteri(A,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(A,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(A,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(A,n.TEXTURE_MAG_FILTER,n.LINEAR),n.activeTexture(n.TEXTURE0)),n.texParameteri(A,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(A,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(A,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(A,n.TEXTURE_MAG_FILTER,n.LINEAR)):(h.vertPosLocation=n.getAttribLocation(h,"a_vertCoord"),n.enableVertexAttribArray(h.vertPosLocation),zt||(zt=n.createBuffer()),st||(st=n.createBuffer()),Ct||(Ct=n.createBuffer()),n.bindBuffer(n.ARRAY_BUFFER,st),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,1,0,1,1,0,1]),n.STATIC_DRAW),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,Ct),n.bufferData(n.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),n.STATIC_DRAW),h.perspUniform=n.getUniformLocation(h,"u_perspMatrix"),h.cubeUniform=n.getUniformLocation(h,"u_cubeMatrix"),h.level=-1,h.currentNodes=[],h.nodeCache=[],h.nodeCacheTimestamp=0),y=n.getError(),y!==0)throw console.log("Error: Something went wrong with WebGL!",y),{type:"webgl error"};l()}},this.destroy=function(){if(B!==w&&(z!==w&&B.contains(z)&&B.removeChild(z),et!==w&&B.contains(et)&&B.removeChild(et)),n){var i=n.getExtension("WEBGL_lose_context");i&&i.loseContext()}},this.resize=function(){var i=Z.devicePixelRatio||1;z.width=z.clientWidth*i,z.height=z.clientHeight*i,n&&(n.getError()==1286&&Bt(),n.viewport(0,0,n.drawingBufferWidth,n.drawingBufferHeight),F!="multires"&&n.uniform1f(h.aspectRatio,z.clientWidth/z.clientHeight))},this.resize(),this.setPose=function(i,r){bt=[i,r]},this.render=function(i,r,L,y){var u,s=0;if(y===w&&(y={}),y.roll&&(s=y.roll),bt!==w){u=bt[0];var l=bt[1],_=i,x=r,E=Math.cos(l)*Math.sin(i)*Math.sin(u)+Math.cos(i)*(Math.cos(u)*Math.cos(r)+Math.sin(l)*Math.sin(u)*Math.sin(r)),D=-Math.sin(i)*Math.sin(l)+Math.cos(i)*Math.cos(l)*Math.sin(r);i=Math.cos(l)*Math.cos(u)*Math.sin(i)+Math.cos(i)*(-Math.cos(r)*Math.sin(u)+Math.cos(u)*Math.sin(l)*Math.sin(r)),i=Math.asin(Math.max(Math.min(i,1),-1)),r=Math.atan2(D,E),u=[Math.cos(_)*(Math.sin(l)*Math.sin(u)*Math.cos(x)-Math.cos(u)*Math.sin(x)),Math.cos(_)*Math.cos(l)*Math.cos(x),Math.cos(_)*(Math.cos(u)*Math.sin(l)*Math.cos(x)+Math.sin(x)*Math.sin(u))],l=[-Math.cos(i)*Math.sin(r),Math.cos(i)*Math.cos(r)],l=Math.acos(Math.max(Math.min((u[0]*l[0]+u[1]*l[1])/(Math.sqrt(u[0]*u[0]+u[1]*u[1]+u[2]*u[2])*Math.sqrt(l[0]*l[0]+l[1]*l[1])),1),-1)),0>u[2]&&(l=2*Math.PI-l),s+=l}if(n||F!="multires"&&F!="cubemap"){if(F!="multires")L=2*Math.atan(Math.tan(.5*L)/(n.drawingBufferWidth/n.drawingBufferHeight)),L=1/Math.tan(.5*L),n.uniform1f(h.psi,r),n.uniform1f(h.theta,i),n.uniform1f(h.rot,s),n.uniform1f(h.f,L),G===!0&&F=="equirectangular"&&(n.bindTexture(n.TEXTURE_2D,h.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,p)),n.drawArrays(n.TRIANGLES,0,6);else{for(u=n.drawingBufferWidth/n.drawingBufferHeight,l=2*Math.atan(Math.tan(L/2)*n.drawingBufferHeight/n.drawingBufferWidth),l=1/Math.tan(l/2),u=[l/u,0,0,0,0,l,0,0,0,0,100.1/-99.9,20/-99.9,0,0,-1,0],l=1;l<p.maxLevel&&n.drawingBufferWidth>p.tileResolution*Math.pow(2,l-1)*Math.tan(L/2)*.707;)l++;if(h.level=l,l=[1,0,0,0,1,0,0,0,1],l=St(l,-s,"z"),l=St(l,-i,"x"),l=St(l,r,"y"),l=[l[0],l[1],l[2],0,l[3],l[4],l[5],0,l[6],l[7],l[8],0,0,0,0,1],n.uniformMatrix4fv(h.perspUniform,!1,new Float32Array(Rt(u))),n.uniformMatrix4fv(h.cubeUniform,!1,new Float32Array(Rt(l))),s=[u[0]*l[0],u[0]*l[1],u[0]*l[2],0,u[5]*l[4],u[5]*l[5],u[5]*l[6],0,u[10]*l[8],u[10]*l[9],u[10]*l[10],u[11],-l[8],-l[9],-l[10],0],h.nodeCache.sort(xt),200<h.nodeCache.length&&h.nodeCache.length>h.currentNodes.length+50)for(u=h.nodeCache.splice(200,h.nodeCache.length-200),l=0;l<u.length;l++)n.deleteTexture(u[l].texture);for(h.currentNodes=[],l="fbudlr".split(""),u=0;6>u;u++)_=new Et(At[u],l[u],1,0,0,p.fullpath),Wt(s,_,i,r);for(h.currentNodes.sort(rt),i=dt.length-1;0<=i;i--)h.currentNodes.indexOf(dt[i].node)===-1&&(dt[i].node.textureLoad=!1,dt.splice(i,1));if(dt.length===0){for(i=0;i<h.currentNodes.length;i++)if(r=h.currentNodes[i],!r.texture&&!r.textureLoad){r.textureLoad=!0,setTimeout(qt,0,r);break}}if(!h.drawInProgress){for(h.drawInProgress=!0,n.clear(n.COLOR_BUFFER_BIT),i=0;i<h.currentNodes.length;i++)1<h.currentNodes[i].textureLoaded&&(n.bindBuffer(n.ARRAY_BUFFER,zt),n.bufferData(n.ARRAY_BUFFER,new Float32Array(h.currentNodes[i].vertices),n.STATIC_DRAW),n.vertexAttribPointer(h.vertPosLocation,3,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,st),n.vertexAttribPointer(h.texCoordLocation,2,n.FLOAT,!1,0,0),n.bindTexture(n.TEXTURE_2D,h.currentNodes[i].texture),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0));h.drawInProgress=!1}}if(y.returnImage!==w)return z.toDataURL("image/png")}else for(u=ft/2,y={f:"translate3d(-"+(u+2)+"px, -"+(u+2)+"px, -"+u+"px)",b:"translate3d("+(u+2)+"px, -"+(u+2)+"px, "+u+"px) rotateX(180deg) rotateZ(180deg)",u:"translate3d(-"+(u+2)+"px, -"+u+"px, "+(u+2)+"px) rotateX(270deg)",d:"translate3d(-"+(u+2)+"px, "+u+"px, -"+(u+2)+"px) rotateX(90deg)",l:"translate3d(-"+u+"px, -"+(u+2)+"px, "+(u+2)+"px) rotateX(180deg) rotateY(90deg) rotateZ(180deg)",r:"translate3d("+u+"px, -"+(u+2)+"px, -"+(u+2)+"px) rotateY(270deg)"},L=1/Math.tan(L/2),L=L*z.clientWidth/2+"px",r="perspective("+L+") translateZ("+L+") rotateX("+i+"rad) rotateY("+r+"rad) ",L=Object.keys(y),i=0;6>i;i++)(s=et.querySelector(".pnlm-"+L[i]+"face"))&&(s.style.webkitTransform=r+y[L[i]],s.style.transform=r+y[L[i]])},this.isLoading=function(){if(n&&F=="multires"){for(var i=0;i<h.currentNodes.length;i++)if(!h.currentNodes[i].textureLoaded)return!0}return!1},this.getCanvas=function(){return z};var dt=[],Zt=function(){function i(){var l=this;this.texture=this.callback=null,this.image=new Image,this.image.crossOrigin=u||"anonymous";var _=function(){if(0<l.image.width&&0<l.image.height){var x=l.image;n.bindTexture(n.TEXTURE_2D,l.texture),n.texImage2D(n.TEXTURE_2D,0,n.RGB,n.RGB,n.UNSIGNED_BYTE,x),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.LINEAR),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.bindTexture(n.TEXTURE_2D,null),l.callback(l.texture,!0)}else l.callback(l.texture,!1);dt.length?(x=dt.shift(),l.loadTexture(x.src,x.texture,x.callback)):y[L++]=l};this.image.addEventListener("load",_),this.image.addEventListener("error",_)}function r(l,_,x,E){this.node=l,this.src=_,this.texture=x,this.callback=E}var L=4,y={},u;i.prototype.loadTexture=function(l,_,x){this.texture=_,this.callback=x,this.image.src=l};for(var s=0;s<L;s++)y[s]=new i;return function(l,_,x,E){return u=E,E=n.createTexture(),L?y[--L].loadTexture(_,E,x):dt.push(new r(l,_,E,x)),E}}()}var I="attribute vec2 a_texCoord;varying vec2 v_texCoord;void main() {gl_Position = vec4(a_texCoord, 0.0, 1.0);v_texCoord = a_texCoord;}",S="attribute vec3 a_vertCoord;attribute vec2 a_texCoord;uniform mat4 u_cubeMatrix;uniform mat4 u_perspMatrix;varying mediump vec2 v_texCoord;void main(void) {gl_Position = u_perspMatrix * u_cubeMatrix * vec4(a_vertCoord, 1.0);v_texCoord = a_texCoord;}",wt=`precision highp float;
uniform float u_aspectRatio;
uniform float u_psi;
uniform float u_theta;
uniform float u_f;
uniform float u_h;
uniform float u_v;
uniform float u_vo;
uniform float u_rot;
const float PI = 3.14159265358979323846264;
uniform sampler2D u_image0;
uniform sampler2D u_image1;
uniform bool u_splitImage;
uniform samplerCube u_imageCube;
varying vec2 v_texCoord;
uniform vec4 u_backgroundColor;
void main() {
float x = v_texCoord.x * u_aspectRatio;
float y = v_texCoord.y;
float sinrot = sin(u_rot);
float cosrot = cos(u_rot);
float rot_x = x * cosrot - y * sinrot;
float rot_y = x * sinrot + y * cosrot;
float sintheta = sin(u_theta);
float costheta = cos(u_theta);
float a = u_f * costheta - rot_y * sintheta;
float root = sqrt(rot_x * rot_x + a * a);
float lambda = atan(rot_x / root, a / root) + u_psi;
float phi = atan((rot_y * costheta + u_f * sintheta) / root);`,Q=wt+`float cosphi = cos(phi);
gl_FragColor = textureCube(u_imageCube, vec3(cosphi*sin(lambda), sin(phi), cosphi*cos(lambda)));
}`,tt=wt+`lambda = mod(lambda + PI, PI * 2.0) - PI;
vec2 coord = vec2(lambda / PI, phi / (PI / 2.0));
if(coord.x < -u_h || coord.x > u_h || coord.y < -u_v + u_vo || coord.y > u_v + u_vo)
gl_FragColor = u_backgroundColor;
else {
if(u_splitImage) {
if(coord.x < 0.0)
gl_FragColor = texture2D(u_image0, vec2((coord.x + u_h) / u_h, (-coord.y + u_v + u_vo) / (u_v * 2.0)));
else
gl_FragColor = texture2D(u_image1, vec2((coord.x + u_h) / u_h - 1.0, (-coord.y + u_v + u_vo) / (u_v * 2.0)));
} else {
gl_FragColor = texture2D(u_image0, vec2((coord.x + u_h) / (u_h * 2.0), (-coord.y + u_v + u_vo) / (u_v * 2.0)));
}
}
}`,_t="varying mediump vec2 v_texCoord;uniform sampler2D u_sampler;void main(void) {gl_FragColor = texture2D(u_sampler, v_texCoord);}";return{renderer:function(B,xt,rt,Et){return new Ut(B)}}}(window,document);window.pannellum=function(Z,d,w){function Ut(I,S){function wt(){var e=d.createElement("div");if(e.innerHTML="<!--[if lte IE 9]><i></i><![endif]-->",e.getElementsByTagName("i").length==1)B();else{Lt=t.hfov,kt=t.pitch;var o;if(t.type=="cubemap"){for(J=[],e=0;6>e;e++)J.push(new Image),J[e].crossOrigin=t.crossOrigin;g.load.lbox.style.display="block",g.load.lbar.style.display="none"}else if(t.type=="multires")e=JSON.parse(JSON.stringify(t.multiRes)),t.basePath&&t.multiRes.basePath&&!/^(?:[a-z]+:)?\/\//i.test(t.multiRes.basePath)?e.basePath=t.basePath+t.multiRes.basePath:t.multiRes.basePath?e.basePath=t.multiRes.basePath:t.basePath&&(e.basePath=t.basePath),J=e;else if(t.dynamic===!0)J=t.panorama;else{if(t.panorama===w){B(t.strings.noPanoramaError);return}J=new Image}if(t.type=="cubemap")for(var a=6,c=function(){a--,a===0&&tt()},f=function(ct){var K=d.createElement("a");K.href=ct.target.src,K.textContent=K.href,B(t.strings.fileAccessError.replace("%s",K.outerHTML))},e=0;e<J.length;e++)o=t.cubeMap[e],o=="null"?(console.log("Will use background instead of missing cubemap face "+e),c()):(t.basePath&&!Q(o)&&(o=t.basePath+o),J[e].onload=c,J[e].onerror=f,J[e].src=U(o));else if(t.type=="multires")tt();else if(o="",t.basePath&&(o=t.basePath),t.dynamic!==!0){o=Q(t.panorama)?t.panorama:o+t.panorama,J.onload=function(){Z.URL.revokeObjectURL(this.src),tt()};var v=new XMLHttpRequest;v.onloadend=function(){if(v.status!=200){var R=d.createElement("a");R.href=o,R.textContent=R.href,B(t.strings.fileAccessError.replace("%s",R.outerHTML))}_t(this.response),g.load.msg.innerHTML=""},v.onprogress=function(R){if(R.lengthComputable){g.load.lbarFill.style.width=R.loaded/R.total*100+"%";var ct,K;1e6<R.total?(ct="MB",K=(R.loaded/1e6).toFixed(2),R=(R.total/1e6).toFixed(2)):1e3<R.total?(ct="kB",K=(R.loaded/1e3).toFixed(1),R=(R.total/1e3).toFixed(1)):(ct="B",K=R.loaded,R=R.total),g.load.msg.innerHTML=K+" / "+R+" "+ct}else g.load.lbox.style.display="block",g.load.lbar.style.display="none"};try{v.open("GET",o,!0)}catch{B(t.strings.malformedURLError)}v.responseType="blob",v.setRequestHeader("Accept","image/*,*/*;q=0.9"),v.withCredentials=t.crossOrigin==="use-credentials",v.send()}t.draggable&&X.classList.add("pnlm-grab"),X.classList.remove("pnlm-grabbing"),Kt=t.dynamicUpdate===!0,t.dynamic&&Kt&&(J=t.panorama,tt())}}function Q(e){return/^(?:[a-z]+:)?\/\//i.test(e)||e[0]=="/"||e.slice(0,5)=="blob:"}function tt(){M||(M=new libpannellum.renderer(q)),te||(te=!0,it.addEventListener("mousedown",Et,!1),d.addEventListener("mousemove",St,!1),d.addEventListener("mouseup",Rt,!1),t.mouseZoom&&(X.addEventListener("mousewheel",nt,!1),X.addEventListener("DOMMouseScroll",nt,!1)),t.doubleClickZoom&&it.addEventListener("dblclick",Wt,!1),I.addEventListener("mozfullscreenchange",l,!1),I.addEventListener("webkitfullscreenchange",l,!1),I.addEventListener("msfullscreenchange",l,!1),I.addEventListener("fullscreenchange",l,!1),Z.addEventListener("resize",F,!1),Z.addEventListener("orientationchange",F,!1),t.disableKeyboardCtrl||(I.addEventListener("keydown",at,!1),I.addEventListener("keyup",et,!1),I.addEventListener("blur",ft,!1)),d.addEventListener("mouseleave",Rt,!1),d.documentElement.style.pointerAction===""&&d.documentElement.style.touchAction===""?(it.addEventListener("pointerdown",z,!1),it.addEventListener("pointermove",h,!1),it.addEventListener("pointerup",n,!1),it.addEventListener("pointerleave",n,!1)):(it.addEventListener("touchstart",qt,!1),it.addEventListener("touchmove",Tt,!1),it.addEventListener("touchend",Bt,!1)),Z.navigator.pointerEnabled&&(I.style.touchAction="none")),Nt(),x(t.hfov),setTimeout(function(){},500)}function _t(e){var o=new FileReader;o.addEventListener("loadend",function(){var a=o.result;if(navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad).* os 8_/)){var c=a.indexOf("ÿÂ");(0>c||65536<c)&&B(t.strings.iOS8WebGLError)}if(c=a.indexOf("<x:xmpmeta"),-1<c&&t.ignoreGPanoXMP!==!0){var f=a.substring(c,a.indexOf("</x:xmpmeta>")+12),$=function(Ft){var vt;return 0<=f.indexOf(Ft+'="')?(vt=f.substring(f.indexOf(Ft+'="')+Ft.length+2),vt=vt.substring(0,vt.indexOf('"'))):0<=f.indexOf(Ft+">")&&(vt=f.substring(f.indexOf(Ft+">")+Ft.length+1),vt=vt.substring(0,vt.indexOf("<"))),vt!==w?Number(vt):null},a=$("GPano:FullPanoWidthPixels"),c=$("GPano:CroppedAreaImageWidthPixels"),v=$("GPano:FullPanoHeightPixels"),R=$("GPano:CroppedAreaImageHeightPixels"),ct=$("GPano:CroppedAreaTopPixels"),K=$("GPano:PoseHeadingDegrees"),ut=$("GPano:PosePitchDegrees"),$=$("GPano:PoseRollDegrees");a!==null&&c!==null&&v!==null&&R!==null&&ct!==null&&(0>pt.indexOf("haov")&&(t.haov=c/a*360),0>pt.indexOf("vaov")&&(t.vaov=R/v*180),0>pt.indexOf("vOffset")&&(t.vOffset=-180*((ct+R/2)/v-.5)),K!==null&&0>pt.indexOf("northOffset")&&(t.northOffset=K,t.compass!==!1&&(t.compass=!0)),ut!==null&&$!==null&&(0>pt.indexOf("horizonPitch")&&(t.horizonPitch=ut),0>pt.indexOf("horizonRoll")&&(t.horizonRoll=$)))}J.src=Z.URL.createObjectURL(e)}),o.readAsBinaryString!==w?o.readAsBinaryString(e):o.readAsText(e)}function B(e){e===w&&(e=t.strings.genericWebGLError),g.errorMsg.innerHTML="<p>"+e+"</p>",T.load.style.display="none",g.load.box.style.display="none",g.errorMsg.style.display="table",$t=!0,H=w,q.style.display="none",N("error",e)}function xt(e){var o=rt(e);yt.style.left=o.x+"px",yt.style.top=o.y+"px",clearTimeout(xt.t1),clearTimeout(xt.t2),yt.style.display="block",yt.style.opacity=1,xt.t1=setTimeout(function(){yt.style.opacity=0},2e3),xt.t2=setTimeout(function(){yt.style.display="none"},2500),e.preventDefault()}function rt(e){var o=I.getBoundingClientRect(),a={};return a.x=(e.clientX||e.pageX)-o.left,a.y=(e.clientY||e.pageY)-o.top,a}function Et(e){if(e.preventDefault(),I.focus(),H&&t.draggable){var o=rt(e);if(t.hotSpotDebug){var a=It(e);console.log("Pitch: "+a[0]+", Yaw: "+a[1]+", Center Pitch: "+t.pitch+", Center Yaw: "+t.yaw+", HFOV: "+t.hfov)}E(),Y(),t.roll=0,C.hfov=0,Mt=!0,V=Date.now(),Gt=o.x,Ht=o.y,Vt=t.yaw,jt=t.pitch,X.classList.add("pnlm-grabbing"),X.classList.remove("pnlm-grab"),N("mousedown",e),G()}}function Wt(e){t.minHfov===t.hfov?k.setHfov(Lt,1e3):(e=It(e),k.lookAt(e[0],e[1],t.minHfov,1e3))}function It(e){var f=rt(e);e=M.getCanvas();var v=e.clientWidth,R=e.clientHeight;e=f.x/v*2-1;var R=(1-f.y/R*2)*R/v,o=1/Math.tan(t.hfov*Math.PI/360),a=Math.sin(t.pitch*Math.PI/180),c=Math.cos(t.pitch*Math.PI/180),f=o*c-R*a,v=Math.sqrt(e*e+f*f),R=180*Math.atan((R*c+o*a)/v)/Math.PI;return e=180*Math.atan2(e/v,f/v)/Math.PI+t.yaw,-180>e&&(e+=360),180<e&&(e-=360),[R,e]}function St(e){if(Mt&&H){V=Date.now();var a=M.getCanvas(),o=a.clientWidth,a=a.clientHeight;e=rt(e);var c=180*(Math.atan(Gt/o*2-1)-Math.atan(e.x/o*2-1))/Math.PI*t.hfov/90+Vt;C.yaw=(c-t.yaw)%360*.2,t.yaw=c,o=360*Math.atan(Math.tan(t.hfov/360*Math.PI)*a/o)/Math.PI,o=180*(Math.atan(e.y/a*2-1)-Math.atan(Ht/a*2-1))/Math.PI*o/90+jt,C.pitch=.2*(o-t.pitch),t.pitch=o}}function Rt(e){Mt&&(Mt=!1,15<Date.now()-V&&(C.pitch=C.yaw=0),X.classList.add("pnlm-grab"),X.classList.remove("pnlm-grabbing"),V=Date.now(),N("mouseup",e))}function qt(e){if(H&&t.draggable){E(),Y(),t.roll=0,C.hfov=0;var o=rt(e.targetTouches[0]);if(Gt=o.x,Ht=o.y,e.targetTouches.length==2){var a=rt(e.targetTouches[1]);Gt+=.5*(a.x-o.x),Ht+=.5*(a.y-o.y),Yt=Math.sqrt((o.x-a.x)*(o.x-a.x)+(o.y-a.y)*(o.y-a.y))}Mt=!0,V=Date.now(),Vt=t.yaw,jt=t.pitch,N("touchstart",e),G()}}function Tt(e){if(t.draggable&&(e.preventDefault(),H&&(V=Date.now()),Mt&&H)){var o=rt(e.targetTouches[0]),a=o.x,c=o.y;e.targetTouches.length==2&&Yt!=-1&&(e=rt(e.targetTouches[1]),a+=.5*(e.x-o.x),c+=.5*(e.y-o.y),o=Math.sqrt((o.x-e.x)*(o.x-e.x)+(o.y-e.y)*(o.y-e.y)),x(t.hfov+.1*(Yt-o)),Yt=o),o=t.hfov/360*t.touchPanSpeedCoeffFactor,a=(Gt-a)*o+Vt,C.yaw=(a-t.yaw)%360*.2,t.yaw=a,c=(c-Ht)*o+jt,C.pitch=.2*(c-t.pitch),t.pitch=c}}function Bt(){Mt=!1,150<Date.now()-V&&(C.pitch=C.yaw=0),Yt=-1,V=Date.now(),N("touchend",event)}function z(e){e.pointerType=="touch"&&H&&t.draggable&&(Pt.push(e.pointerId),Ot.push({clientX:e.clientX,clientY:e.clientY}),e.targetTouches=Ot,qt(e),e.preventDefault())}function h(e){if(e.pointerType=="touch"&&t.draggable){for(var o=0;o<Pt.length;o++)if(e.pointerId==Pt[o]){Ot[o].clientX=e.clientX,Ot[o].clientY=e.clientY,e.targetTouches=Ot,Tt(e),e.preventDefault();break}}}function n(e){if(e.pointerType=="touch"){for(var o=!1,a=0;a<Pt.length;a++)e.pointerId==Pt[a]&&(Pt[a]=w),Pt[a]&&(o=!0);o||(Pt=[],Ot=[],Bt()),e.preventDefault()}}function nt(e){H&&(t.mouseZoom!="fullscreenonly"||Dt)&&(e.preventDefault(),E(),V=Date.now(),e.wheelDeltaY?(x(t.hfov-.05*e.wheelDeltaY),C.hfov=0>e.wheelDelta?1:-1):e.wheelDelta?(x(t.hfov-.05*e.wheelDelta),C.hfov=0>e.wheelDelta?1:-1):e.detail&&(x(t.hfov+1.5*e.detail),C.hfov=0<e.detail?1:-1),G())}function at(e){E(),V=Date.now(),Y(),t.roll=0;var o=e.which||e.keycode;0>t.capturedKeyNumbers.indexOf(o)||(e.preventDefault(),o==27?Dt&&s():At(o,!0))}function ft(){for(var e=0;10>e;e++)b[e]=!1}function et(e){var o=e.which||e.keycode;0>t.capturedKeyNumbers.indexOf(o)||(e.preventDefault(),At(o,!1))}function At(e,o){var a=!1;switch(e){case 109:case 189:case 17:case 173:b[0]!=o&&(a=!0),b[0]=o;break;case 107:case 187:case 16:case 61:b[1]!=o&&(a=!0),b[1]=o;break;case 38:b[2]!=o&&(a=!0),b[2]=o;break;case 87:b[6]!=o&&(a=!0),b[6]=o;break;case 40:b[3]!=o&&(a=!0),b[3]=o;break;case 83:b[7]!=o&&(a=!0),b[7]=o;break;case 37:b[4]!=o&&(a=!0),b[4]=o;break;case 65:b[8]!=o&&(a=!0),b[8]=o;break;case 39:b[5]!=o&&(a=!0),b[5]=o;break;case 68:b[9]!=o&&(a=!0),b[9]=o}a&&o&&(mt=typeof performance<"u"&&performance.now()?performance.now():Date.now(),G())}function bt(){if(H){var e=!1,o=t.pitch,a=t.yaw,c=t.hfov,f;f=typeof performance<"u"&&performance.now()?performance.now():Date.now(),mt===w&&(mt=f);var v=(f-mt)*t.hfov/1700,v=Math.min(v,1);if(b[0]&&t.keyboardZoom===!0&&(x(t.hfov+(.8*C.hfov+.5)*v),e=!0),b[1]&&t.keyboardZoom===!0&&(x(t.hfov+(.8*C.hfov-.2)*v),e=!0),(b[2]||b[6])&&(t.pitch+=(.8*C.pitch+.2)*v,e=!0),(b[3]||b[7])&&(t.pitch+=(.8*C.pitch-.2)*v,e=!0),(b[4]||b[8])&&(t.yaw+=(.8*C.yaw-.2)*v,e=!0),(b[5]||b[9])&&(t.yaw+=(.8*C.yaw+.2)*v,e=!0),e&&(V=Date.now()),t.autoRotate){if(.001<f-mt){var e=(f-mt)/1e3,R=(C.yaw/e*v-.2*t.autoRotate)*e,R=(0<-t.autoRotate?1:-1)*Math.min(Math.abs(t.autoRotate*e),Math.abs(R));t.yaw+=R}t.autoRotateStopDelay&&(t.autoRotateStopDelay-=f-mt,0>=t.autoRotateStopDelay&&(t.autoRotateStopDelay=!1,ht=t.autoRotate,t.autoRotate=0))}j.pitch&&(p("pitch"),o=t.pitch),j.yaw&&(p("yaw"),a=t.yaw),j.hfov&&(p("hfov"),c=t.hfov),0<v&&!t.autoRotate&&(e=1-t.friction,b[4]||b[5]||b[8]||b[9]||j.yaw||(t.yaw+=C.yaw*v*e),b[2]||b[3]||b[6]||b[7]||j.pitch||(t.pitch+=C.pitch*v*e),b[0]||b[1]||j.hfov||x(t.hfov+C.hfov*v*e)),mt=f,0<v&&(C.yaw=.8*C.yaw+(t.yaw-a)/v*.2,C.pitch=.8*C.pitch+(t.pitch-o)/v*.2,C.hfov=.8*C.hfov+(t.hfov-c)/v*.2,o=t.autoRotate?Math.abs(t.autoRotate):5,C.yaw=Math.min(o,Math.max(C.yaw,-o)),C.pitch=Math.min(o,Math.max(C.pitch,-o)),C.hfov=Math.min(o,Math.max(C.hfov,-o))),b[0]&&b[1]&&(C.hfov=0),(b[2]||b[6])&&(b[3]||b[7])&&(C.pitch=0),(b[4]||b[8])&&(b[5]||b[9])&&(C.yaw=0)}}function p(e){var o=j[e],a=Math.min(1,Math.max((Date.now()-o.startTime)/1e3/(o.duration/1e3),0)),a=o.startPosition+t.animationTimingFunction(a)*(o.endPosition-o.startPosition);(o.endPosition>o.startPosition&&a>=o.endPosition||o.endPosition<o.startPosition&&a<=o.endPosition||o.endPosition===o.startPosition)&&(a=o.endPosition,C[e]=0,delete j[e]),t[e]=a}function F(){l("resize")}function G(){ee||(ee=!0,gt())}function gt(){if(!le)if(zt(),Jt&&clearTimeout(Jt),Mt||lt===!0)requestAnimationFrame(gt);else if(b[0]||b[1]||b[2]||b[3]||b[4]||b[5]||b[6]||b[7]||b[8]||b[9]||t.autoRotate||j.pitch||j.yaw||j.hfov||.01<Math.abs(C.yaw)||.01<Math.abs(C.pitch)||.01<Math.abs(C.hfov))bt(),0<=t.autoRotateInactivityDelay&&ht&&Date.now()-V>t.autoRotateInactivityDelay&&!t.autoRotate&&(t.autoRotate=ht,k.lookAt(kt,w,Lt,3e3)),requestAnimationFrame(gt);else if(M&&(M.isLoading()||t.dynamic===!0&&Kt))requestAnimationFrame(gt);else{N("animatefinished",{pitch:k.getPitch(),yaw:k.getYaw(),hfov:k.getHfov()}),ee=!1,mt=w;var e=t.autoRotateInactivityDelay-(Date.now()-V);0<e?Jt=setTimeout(function(){t.autoRotate=ht,k.lookAt(kt,w,Lt,3e3),G()},e):0<=t.autoRotateInactivityDelay&&ht&&(t.autoRotate=ht,k.lookAt(kt,w,Lt,3e3),G())}}function zt(){var e;if(H){var o=M.getCanvas();t.autoRotate!==!1&&(360<t.yaw?t.yaw-=360:-360>t.yaw&&(t.yaw+=360)),e=t.yaw;var a=0;if(t.avoidShowingBackground){var c=t.hfov/2,f=180*Math.atan2(Math.tan(c/180*Math.PI),o.width/o.height)/Math.PI;t.vaov>t.haov?Math.min(Math.cos((t.pitch-c)/180*Math.PI),Math.cos((t.pitch+c)/180*Math.PI)):a=c*(1-Math.min(Math.cos((t.pitch-f)/180*Math.PI),Math.cos((t.pitch+f)/180*Math.PI)))}var c=t.maxYaw-t.minYaw,f=-180,v=180;360>c&&(f=t.minYaw+t.hfov/2+a,v=t.maxYaw-t.hfov/2-a,c<t.hfov&&(f=v=(f+v)/2),t.yaw=Math.max(f,Math.min(v,t.yaw))),t.autoRotate===!1&&(360<t.yaw?t.yaw-=360:-360>t.yaw&&(t.yaw+=360)),t.autoRotate!==!1&&e!=t.yaw&&mt!==w&&(t.autoRotate*=-1),e=2*Math.atan(Math.tan(t.hfov/180*Math.PI*.5)/(o.width/o.height))/Math.PI*180,o=t.minPitch+e/2,a=t.maxPitch-e/2,t.maxPitch-t.minPitch<e&&(o=a=(o+a)/2),isNaN(o)&&(o=-90),isNaN(a)&&(a=90),t.pitch=Math.max(o,Math.min(a,t.pitch)),M.render(t.pitch*Math.PI/180,t.yaw*Math.PI/180,t.hfov*Math.PI/180,{roll:t.roll*Math.PI/180}),t.hotSpots.forEach(L),t.compass&&(Xt.style.transform="rotate("+(-t.yaw-t.northOffset)+"deg)",Xt.style.webkitTransform="rotate("+(-t.yaw-t.northOffset)+"deg)")}}function st(e,o,a,c){this.w=e,this.x=o,this.y=a,this.z=c}function Ct(e){var o;o=e.alpha;var a=e.beta;e=e.gamma,a=[a?a*Math.PI/180/2:0,e?e*Math.PI/180/2:0,o?o*Math.PI/180/2:0],o=[Math.cos(a[0]),Math.cos(a[1]),Math.cos(a[2])],a=[Math.sin(a[0]),Math.sin(a[1]),Math.sin(a[2])],o=new st(o[0]*o[1]*o[2]-a[0]*a[1]*a[2],a[0]*o[1]*o[2]-o[0]*a[1]*a[2],o[0]*a[1]*o[2]+a[0]*o[1]*a[2],o[0]*o[1]*a[2]+a[0]*a[1]*o[2]),o=o.multiply(new st(Math.sqrt(.5),-Math.sqrt(.5),0,0)),a=Z.orientation?-Z.orientation*Math.PI/180/2:0,o=o.multiply(new st(Math.cos(a),0,-Math.sin(a),0)).toEulerAngles(),typeof lt=="number"&&10>lt?lt+=1:lt===10?(se=o[2]/Math.PI*180+t.yaw,lt=!0,requestAnimationFrame(gt)):(t.pitch=o[0]/Math.PI*180,t.roll=-o[1]/Math.PI*180,t.yaw=-o[2]/Math.PI*180+se)}function Nt(){try{var e={};t.horizonPitch!==w&&(e.horizonPitch=t.horizonPitch*Math.PI/180),t.horizonRoll!==w&&(e.horizonRoll=t.horizonRoll*Math.PI/180),t.backgroundColor!==w&&(e.backgroundColor=t.backgroundColor),M.init(J,t.type,t.dynamic,t.haov*Math.PI/180,t.vaov*Math.PI/180,t.vOffset*Math.PI/180,dt,e),t.dynamic!==!0&&(J=w)}catch(o){if(o.type=="webgl error"||o.type=="no webgl")B();else if(o.type=="webgl size error")B(t.strings.textureSizeError.replace("%s",o.width).replace("%s",o.maxWidth));else throw B(t.strings.unknownError),o}}function dt(){if(t.sceneFadeDuration&&M.fadeImg!==w){M.fadeImg.style.opacity=0;var e=M.fadeImg;delete M.fadeImg,setTimeout(function(){q.removeChild(e),N("scenechangefadedone")},t.sceneFadeDuration)}Xt.style.display=t.compass?"inline":"none",i(),g.load.box.style.display="none",P!==w&&(q.removeChild(P),P=w),H=!0,N("load"),G()}function Zt(e){e.pitch=Number(e.pitch)||0,e.yaw=Number(e.yaw)||0;var o=d.createElement("div");o.className="pnlm-hotspot-base",o.className=e.cssClass?o.className+(" "+e.cssClass):o.className+(" pnlm-hotspot pnlm-sprite pnlm-"+O(e.type));var a=d.createElement("span");e.text&&(a.innerHTML=O(e.text));var c;if(e.video){c=d.createElement("video");var f=e.video;t.basePath&&!Q(f)&&(f=t.basePath+f),c.src=U(f),c.controls=!0,c.style.width=e.width+"px",q.appendChild(o),a.appendChild(c)}else if(e.image){f=e.image,t.basePath&&!Q(f)&&(f=t.basePath+f),c=d.createElement("a"),c.href=U(e.URL?e.URL:f,!0),c.target="_blank",a.appendChild(c);var v=d.createElement("img");v.src=U(f),v.style.width=e.width+"px",v.style.paddingTop="5px",q.appendChild(o),c.appendChild(v),a.style.maxWidth="initial"}else if(e.URL){if(c=d.createElement("a"),c.href=U(e.URL,!0),e.attributes)for(f in e.attributes)c.setAttribute(f,e.attributes[f]);else c.target="_blank";q.appendChild(c),o.className+=" pnlm-pointer",a.className+=" pnlm-pointer",c.appendChild(o)}else e.sceneId&&(o.onclick=o.ontouchend=function(){return o.clicked||(o.clicked=!0,A(e.sceneId,e.targetPitch,e.targetYaw,e.targetHfov)),!1},o.className+=" pnlm-pointer",a.className+=" pnlm-pointer"),q.appendChild(o);e.createTooltipFunc?e.createTooltipFunc(o,e.createTooltipArgs):(e.text||e.video||e.image)&&(o.classList.add("pnlm-tooltip"),o.appendChild(a),a.style.width=a.scrollWidth-20+"px",a.style.marginLeft=-(a.scrollWidth-o.offsetWidth)/2+"px",a.style.marginTop=-a.scrollHeight-12+"px"),e.clickHandlerFunc&&(o.addEventListener("click",function(R){e.clickHandlerFunc(R,e.clickHandlerArgs)},"false"),o.className+=" pnlm-pointer",a.className+=" pnlm-pointer"),e.div=o}function i(){oe||(t.hotSpots?(t.hotSpots=t.hotSpots.sort(function(e,o){return e.pitch<o.pitch}),t.hotSpots.forEach(Zt)):t.hotSpots=[],oe=!0,t.hotSpots.forEach(L))}function r(){var e=t.hotSpots;if(oe=!1,delete t.hotSpots,e)for(var o=0;o<e.length;o++){var a=e[o].div;if(a){for(;a.parentNode&&a.parentNode!=q;)a=a.parentNode;q.removeChild(a)}delete e[o].div}}function L(e){var o=Math.sin(e.pitch*Math.PI/180),a=Math.cos(e.pitch*Math.PI/180),c=Math.sin(t.pitch*Math.PI/180),f=Math.cos(t.pitch*Math.PI/180),v=Math.cos((-e.yaw+t.yaw)*Math.PI/180),R=o*c+a*v*f;if(90>=e.yaw&&-90<e.yaw&&0>=R||(90<e.yaw||-90>=e.yaw)&&0>=R)e.div.style.visibility="hidden";else{var ct=Math.sin((-e.yaw+t.yaw)*Math.PI/180),K=Math.tan(t.hfov*Math.PI/360);e.div.style.visibility="visible";var $=M.getCanvas(),ut=$.clientWidth,$=$.clientHeight,o=[-ut/K*ct*a/R/2,-ut/K*(o*f-a*v*c)/R/2],a=Math.sin(t.roll*Math.PI/180),c=Math.cos(t.roll*Math.PI/180),o=[o[0]*c-o[1]*a,o[0]*a+o[1]*c];o[0]+=(ut-e.div.offsetWidth)/2,o[1]+=($-e.div.offsetHeight)/2,ut="translate("+o[0]+"px, "+o[1]+"px) translateZ(9999px) rotate("+t.roll+"deg)",e.scale&&(ut+=" scale("+Lt/t.hfov/R+")"),e.div.style.webkitTransform=ut,e.div.style.MozTransform=ut,e.div.style.transform=ut}}function y(e){t={};var o,a,c="haov vaov vOffset northOffset horizonPitch horizonRoll".split(" ");pt=[];for(o in ne)ne.hasOwnProperty(o)&&(t[o]=ne[o]);for(o in S.default)if(S.default.hasOwnProperty(o))if(o=="strings")for(a in S.default.strings)S.default.strings.hasOwnProperty(a)&&(t.strings[a]=O(S.default.strings[a]));else t[o]=S.default[o],0<=c.indexOf(o)&&pt.push(o);if(e!==null&&e!==""&&S.scenes&&S.scenes[e]){var f=S.scenes[e];for(o in f)if(f.hasOwnProperty(o))if(o=="strings")for(a in f.strings)f.strings.hasOwnProperty(a)&&(t.strings[a]=O(f.strings[a]));else t[o]=f[o],0<=c.indexOf(o)&&pt.push(o);t.scene=e}for(o in S)if(S.hasOwnProperty(o))if(o=="strings")for(a in S.strings)S.strings.hasOwnProperty(a)&&(t.strings[a]=O(S.strings[a]));else t[o]=S[o],0<=c.indexOf(o)&&pt.push(o)}function u(e){if((e=e||!1)&&"preview"in t){var o=t.preview;t.basePath&&!Q(o)&&(o=t.basePath+o),P=d.createElement("div"),P.className="pnlm-preview-img",P.style.backgroundImage="url('"+U(o).replace(/"/g,"%22").replace(/'/g,"%27")+"')",q.appendChild(P)}var o=t.title,a=t.author;e&&("previewTitle"in t&&(t.title=t.previewTitle),"previewAuthor"in t&&(t.author=t.previewAuthor)),t.hasOwnProperty("title")||(g.title.innerHTML=""),t.hasOwnProperty("author")||(g.author.innerHTML=""),t.hasOwnProperty("title")||t.hasOwnProperty("author")||(g.container.style.display="none"),T.load.innerHTML="<p>"+t.strings.loadButtonLabel+"</p>",g.load.boxp.innerHTML=t.strings.loadingLabel;for(var c in t)if(t.hasOwnProperty(c))switch(c){case"title":g.title.innerHTML=O(t[c]),g.container.style.display="inline";break;case"author":var f=O(t[c]);t.authorURL&&(f=d.createElement("a"),f.href=U(t.authorURL,!0),f.target="_blank",f.innerHTML=O(t[c]),f=f.outerHTML),g.author.innerHTML=t.strings.bylineLabel.replace("%s",f),g.container.style.display="inline";break;case"fallback":f=d.createElement("a"),f.href=U(t[c],!0),f.target="_blank",f.textContent="Click here to view this panorama in an alternative viewer.";var v=d.createElement("p");v.textContent="Your browser does not support WebGL.",v.appendChild(d.createElement("br")),v.appendChild(f),g.errorMsg.innerHTML="",g.errorMsg.appendChild(v);break;case"hfov":x(Number(t[c]));break;case"autoLoad":t[c]===!0&&M===w&&(g.load.box.style.display="inline",T.load.style.display="none",wt());break;case"showZoomCtrl":T.zoom.style.display=t[c]&&t.showControls!=!1?"block":"none";break;case"showFullscreenCtrl":T.fullscreen.style.display=t[c]&&t.showControls!=!1&&("fullscreen"in d||"mozFullScreen"in d||"webkitIsFullScreen"in d||"msFullscreenElement"in d)?"block":"none";break;case"hotSpotDebug":ae.style.display=t[c]?"block":"none";break;case"showControls":t[c]||(T.orientation.style.display="none",T.zoom.style.display="none",T.fullscreen.style.display="none");break;case"orientationOnByDefault":t[c]&&W()}e&&(o?t.title=o:delete t.title,a?t.author=a:delete t.author)}function s(){if(H&&!$t)if(Dt)d.exitFullscreen?d.exitFullscreen():d.mozCancelFullScreen?d.mozCancelFullScreen():d.webkitCancelFullScreen?d.webkitCancelFullScreen():d.msExitFullscreen&&d.msExitFullscreen();else try{I.requestFullscreen?I.requestFullscreen():I.mozRequestFullScreen?I.mozRequestFullScreen():I.msRequestFullscreen?I.msRequestFullscreen():I.webkitRequestFullScreen()}catch{}}function l(e){d.fullscreenElement||d.fullscreen||d.mozFullScreen||d.webkitIsFullScreen||d.msFullscreenElement?(T.fullscreen.classList.add("pnlm-fullscreen-toggle-button-active"),Dt=!0):(T.fullscreen.classList.remove("pnlm-fullscreen-toggle-button-active"),Dt=!1),e!=="resize"&&N("fullscreenchange",Dt),M.resize(),x(t.hfov),G()}function _(e){var o=t.minHfov;if(t.type=="multires"&&M&&!t.multiResMinHfov&&(o=Math.min(o,M.getCanvas().width/(t.multiRes.cubeResolution/90*.9))),o>t.maxHfov)return console.log("HFOV bounds do not make sense (minHfov > maxHfov)."),t.hfov;var a=t.hfov,a=e<o?o:e>t.maxHfov?t.maxHfov:e;return t.avoidShowingBackground&&M&&(e=M.getCanvas(),a=Math.min(a,360*Math.atan(Math.tan((t.maxPitch-t.minPitch)/360*Math.PI)/e.height*e.width)/Math.PI)),a}function x(e){t.hfov=_(e),N("zoomchange",t.hfov)}function E(){j={},ht=t.autoRotate?t.autoRotate:ht,t.autoRotate=!1}function D(){$t&&(g.load.box.style.display="none",g.errorMsg.style.display="none",$t=!1,q.style.display="block",N("errorcleared")),H=!1,T.load.style.display="none",g.load.box.style.display="inline",wt()}function A(e,o,a,c,f){H||(f=!0),H=!1,j={};var v,R;if(t.sceneFadeDuration&&!f&&(v=M.render(t.pitch*Math.PI/180,t.yaw*Math.PI/180,t.hfov*Math.PI/180,{returnImage:!0}),v!==w)){f=new Image,f.className="pnlm-fade-img",f.style.transition="opacity "+t.sceneFadeDuration/1e3+"s",f.style.width="100%",f.style.height="100%",f.onload=function(){A(e,o,a,c,!0)},f.src=v,q.appendChild(f),M.fadeImg=f;return}f=o==="same"?t.pitch:o,v=a==="same"?t.yaw:a==="sameAzimuth"?t.yaw+(t.northOffset||0)-(S.scenes[e].northOffset||0):a,R=c==="same"?t.hfov:c,r(),y(e),C.yaw=C.pitch=C.hfov=0,u(),f!==w&&(t.pitch=f),v!==w&&(t.yaw=v),R!==w&&(t.hfov=R),N("scenechange",e),D()}function Y(){Z.removeEventListener("deviceorientation",Ct),T.orientation.classList.remove("pnlm-orientation-button-active"),lt=!1}function W(){typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(function(e){e=="granted"&&(lt=1,Z.addEventListener("deviceorientation",Ct),T.orientation.classList.add("pnlm-orientation-button-active"))}):(lt=1,Z.addEventListener("deviceorientation",Ct),T.orientation.classList.add("pnlm-orientation-button-active"))}function O(e){return S.escapeHTML?String(e).split(/&/g).join("&amp;").split('"').join("&quot;").split("'").join("&#39;").split("<").join("&lt;").split(">").join("&gt;").split("/").join("&#x2f;").split(`
`).join("<br>"):String(e).split(`
`).join("<br>")}function U(e,o){try{var a=decodeURIComponent(m(e)).replace(/[^\w:]/g,"").toLowerCase()}catch{return"about:blank"}return a.indexOf("javascript:")===0||a.indexOf("vbscript:")===0?(console.log("Script URL removed."),"about:blank"):o&&a.indexOf("data:")===0?(console.log("Data URI removed from link."),"about:blank"):e}function m(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,function(o,a){return a=a.toLowerCase(),a==="colon"?":":a.charAt(0)==="#"?a.charAt(1)==="x"?String.fromCharCode(parseInt(a.substring(2),16)):String.fromCharCode(+a.substring(1)):""})}function N(e){if(e in ot)for(var o=ot[e].length;0<o;o--)ot[e][ot[e].length-o].apply(null,[].slice.call(arguments,1))}var k=this,t,M,P,Mt=!1,V=Date.now(),Gt=0,Ht=0,Yt=-1,Vt=0,jt=0,b=Array(10),Dt=!1,H,$t=!1,te=!1,J,mt,C={yaw:0,pitch:0,hfov:0},ee=!1,lt=!1,se=0,Jt,ht=0,Lt,kt,j={},ot={},pt=[],Kt=!1,oe=!1,le=!1,ne={hfov:100,minHfov:50,multiResMinHfov:!1,maxHfov:120,pitch:0,minPitch:w,maxPitch:w,yaw:0,minYaw:-180,maxYaw:180,roll:0,haov:360,vaov:180,vOffset:0,autoRotate:!1,autoRotateInactivityDelay:-1,autoRotateStopDelay:w,type:"equirectangular",northOffset:0,showFullscreenCtrl:!0,dynamic:!1,dynamicUpdate:!1,doubleClickZoom:!0,keyboardZoom:!0,mouseZoom:!0,showZoomCtrl:!0,autoLoad:!1,showControls:!0,orientationOnByDefault:!1,hotSpotDebug:!1,backgroundColor:[0,0,0],avoidShowingBackground:!1,animationTimingFunction:function(e){return .5>e?2*e*e:-1+(4-2*e)*e},draggable:!0,disableKeyboardCtrl:!1,crossOrigin:"anonymous",touchPanSpeedCoeffFactor:1,capturedKeyNumbers:[16,17,27,37,38,39,40,61,65,68,83,87,107,109,173,187,189],friction:.15,strings:{loadButtonLabel:"Click to<br>Load<br>Panorama",loadingLabel:"Loading...",bylineLabel:"by %s",noPanoramaError:"No panorama image was specified.",fileAccessError:"The file %s could not be accessed.",malformedURLError:"There is something wrong with the panorama URL.",iOS8WebGLError:"Due to iOS 8's broken WebGL implementation, only progressive encoded JPEGs work for your device (this panorama uses standard encoding).",genericWebGLError:"Your browser does not have the necessary WebGL support to display this panorama.",textureSizeError:"This panorama is too big for your device! It's %spx wide, but your device only supports images up to %spx wide. Try another device. (If you're the author, try scaling down the image.)",unknownError:"Unknown error. Check developer console."}};I=typeof I=="string"?d.getElementById(I):I,I.classList.add("pnlm-container"),I.tabIndex=0;var X=d.createElement("div");X.className="pnlm-ui",I.appendChild(X);var q=d.createElement("div");q.className="pnlm-render-container",I.appendChild(q);var it=d.createElement("div");it.className="pnlm-dragfix",X.appendChild(it);var yt=d.createElement("span");yt.className="pnlm-about-msg",yt.innerHTML='<a href="https://pannellum.org/" target="_blank">Pannellum</a> 2.5.6',X.appendChild(yt),it.addEventListener("contextmenu",xt);var g={},ae=d.createElement("div");ae.className="pnlm-sprite pnlm-hot-spot-debug-indicator",X.appendChild(ae),g.container=d.createElement("div"),g.container.className="pnlm-panorama-info",g.title=d.createElement("div"),g.title.className="pnlm-title-box",g.container.appendChild(g.title),g.author=d.createElement("div"),g.author.className="pnlm-author-box",g.container.appendChild(g.author),X.appendChild(g.container),g.load={},g.load.box=d.createElement("div"),g.load.box.className="pnlm-load-box",g.load.boxp=d.createElement("p"),g.load.box.appendChild(g.load.boxp),g.load.lbox=d.createElement("div"),g.load.lbox.className="pnlm-lbox",g.load.lbox.innerHTML='<div class="pnlm-loading"></div>',g.load.box.appendChild(g.load.lbox),g.load.lbar=d.createElement("div"),g.load.lbar.className="pnlm-lbar",g.load.lbarFill=d.createElement("div"),g.load.lbarFill.className="pnlm-lbar-fill",g.load.lbar.appendChild(g.load.lbarFill),g.load.box.appendChild(g.load.lbar),g.load.msg=d.createElement("p"),g.load.msg.className="pnlm-lmsg",g.load.box.appendChild(g.load.msg),X.appendChild(g.load.box),g.errorMsg=d.createElement("div"),g.errorMsg.className="pnlm-error-msg pnlm-info-box",X.appendChild(g.errorMsg);var T={};T.container=d.createElement("div"),T.container.className="pnlm-controls-container",X.appendChild(T.container),T.load=d.createElement("div"),T.load.className="pnlm-load-button",T.load.addEventListener("click",function(){u(),D()}),X.appendChild(T.load),T.zoom=d.createElement("div"),T.zoom.className="pnlm-zoom-controls pnlm-controls",T.zoomIn=d.createElement("div"),T.zoomIn.className="pnlm-zoom-in pnlm-sprite pnlm-control",T.zoomIn.addEventListener("click",function(){H&&(x(t.hfov-5),G())}),T.zoom.appendChild(T.zoomIn),T.zoomOut=d.createElement("div"),T.zoomOut.className="pnlm-zoom-out pnlm-sprite pnlm-control",T.zoomOut.addEventListener("click",function(){H&&(x(t.hfov+5),G())}),T.zoom.appendChild(T.zoomOut),T.container.appendChild(T.zoom),T.fullscreen=d.createElement("div"),T.fullscreen.addEventListener("click",s),T.fullscreen.className="pnlm-fullscreen-toggle-button pnlm-sprite pnlm-fullscreen-toggle-button-inactive pnlm-controls pnlm-control",(d.fullscreenEnabled||d.mozFullScreenEnabled||d.webkitFullscreenEnabled||d.msFullscreenEnabled)&&T.container.appendChild(T.fullscreen),T.orientation=d.createElement("div"),T.orientation.addEventListener("click",function(e){lt?Y():W()}),T.orientation.addEventListener("mousedown",function(e){e.stopPropagation()}),T.orientation.addEventListener("touchstart",function(e){e.stopPropagation()}),T.orientation.addEventListener("pointerdown",function(e){e.stopPropagation()}),T.orientation.className="pnlm-orientation-button pnlm-orientation-button-inactive pnlm-sprite pnlm-controls pnlm-control";var ie=!1;Z.DeviceOrientationEvent&&location.protocol=="https:"&&0<=navigator.userAgent.toLowerCase().indexOf("mobi")&&(T.container.appendChild(T.orientation),ie=!0);var Xt=d.createElement("div");Xt.className="pnlm-compass pnlm-controls pnlm-control",X.appendChild(Xt),S.firstScene?y(S.firstScene):S.default&&S.default.firstScene?y(S.default.firstScene):y(null),u(!0);var Pt=[],Ot=[];st.prototype.multiply=function(e){return new st(this.w*e.w-this.x*e.x-this.y*e.y-this.z*e.z,this.x*e.w+this.w*e.x+this.y*e.z-this.z*e.y,this.y*e.w+this.w*e.y+this.z*e.x-this.x*e.z,this.z*e.w+this.w*e.z+this.x*e.y-this.y*e.x)},st.prototype.toEulerAngles=function(){var e=Math.atan2(2*(this.w*this.x+this.y*this.z),1-2*(this.x*this.x+this.y*this.y)),o=Math.asin(2*(this.w*this.y-this.z*this.x)),a=Math.atan2(2*(this.w*this.z+this.x*this.y),1-2*(this.y*this.y+this.z*this.z));return[e,o,a]},this.isLoaded=function(){return!!H},this.getPitch=function(){return t.pitch},this.setPitch=function(e,o,a,c){return V=Date.now(),1e-6>=Math.abs(e-t.pitch)?(typeof a=="function"&&a(c),this):((o=o==w?1e3:Number(o))?(j.pitch={startTime:Date.now(),startPosition:t.pitch,endPosition:e,duration:o},typeof a=="function"&&setTimeout(function(){a(c)},o)):t.pitch=e,G(),this)},this.getPitchBounds=function(){return[t.minPitch,t.maxPitch]},this.setPitchBounds=function(e){return t.minPitch=Math.max(-90,Math.min(e[0],90)),t.maxPitch=Math.max(-90,Math.min(e[1],90)),this},this.getYaw=function(){return(t.yaw+540)%360-180},this.setYaw=function(e,o,a,c){return V=Date.now(),1e-6>=Math.abs(e-t.yaw)?(typeof a=="function"&&a(c),this):(o=o==w?1e3:Number(o),e=(e+180)%360-180,o?(180<t.yaw-e?e+=360:180<e-t.yaw&&(e-=360),j.yaw={startTime:Date.now(),startPosition:t.yaw,endPosition:e,duration:o},typeof a=="function"&&setTimeout(function(){a(c)},o)):t.yaw=e,G(),this)},this.getYawBounds=function(){return[t.minYaw,t.maxYaw]},this.setYawBounds=function(e){return t.minYaw=Math.max(-360,Math.min(e[0],360)),t.maxYaw=Math.max(-360,Math.min(e[1],360)),this},this.getHfov=function(){return t.hfov},this.setHfov=function(e,o,a,c){return V=Date.now(),1e-6>=Math.abs(e-t.hfov)?(typeof a=="function"&&a(c),this):((o=o==w?1e3:Number(o))?(j.hfov={startTime:Date.now(),startPosition:t.hfov,endPosition:_(e),duration:o},typeof a=="function"&&setTimeout(function(){a(c)},o)):x(e),G(),this)},this.getHfovBounds=function(){return[t.minHfov,t.maxHfov]},this.setHfovBounds=function(e){return t.minHfov=Math.max(0,e[0]),t.maxHfov=Math.max(0,e[1]),this},this.lookAt=function(e,o,a,c,f,v){return c=c==w?1e3:Number(c),e!==w&&1e-6<Math.abs(e-t.pitch)&&(this.setPitch(e,c,f,v),f=w),o!==w&&1e-6<Math.abs(o-t.yaw)&&(this.setYaw(o,c,f,v),f=w),a!==w&&1e-6<Math.abs(a-t.hfov)&&(this.setHfov(a,c,f,v),f=w),typeof f=="function"&&f(v),this},this.getNorthOffset=function(){return t.northOffset},this.setNorthOffset=function(e){return t.northOffset=Math.min(360,Math.max(0,e)),G(),this},this.getHorizonRoll=function(){return t.horizonRoll},this.setHorizonRoll=function(e){return t.horizonRoll=Math.min(90,Math.max(-90,e)),M.setPose(t.horizonPitch*Math.PI/180,t.horizonRoll*Math.PI/180),G(),this},this.getHorizonPitch=function(){return t.horizonPitch},this.setHorizonPitch=function(e){return t.horizonPitch=Math.min(90,Math.max(-90,e)),M.setPose(t.horizonPitch*Math.PI/180,t.horizonRoll*Math.PI/180),G(),this},this.startAutoRotate=function(e,o){return e=e||ht||1,o=o===w?kt:o,t.autoRotate=e,k.lookAt(o,w,Lt,3e3),G(),this},this.stopAutoRotate=function(){return ht=t.autoRotate?t.autoRotate:ht,t.autoRotate=!1,t.autoRotateInactivityDelay=-1,this},this.stopMovement=function(){E(),C={yaw:0,pitch:0,hfov:0}},this.getRenderer=function(){return M},this.setUpdate=function(e){return Kt=e===!0,M===w?tt():G(),this},this.mouseEventToCoords=function(e){return It(e)},this.loadScene=function(e,o,a,c){return H!==!1&&A(e,o,a,c),this},this.getScene=function(){return t.scene},this.addScene=function(e,o){return S.scenes[e]=o,this},this.removeScene=function(e){return t.scene===e||!S.scenes.hasOwnProperty(e)?!1:(delete S.scenes[e],!0)},this.toggleFullscreen=function(){return s(),this},this.getConfig=function(){return t},this.getContainer=function(){return I},this.addHotSpot=function(e,o){if(o===w&&t.scene===w)t.hotSpots.push(e);else{var a=o!==w?o:t.scene;if(S.scenes.hasOwnProperty(a))S.scenes[a].hasOwnProperty("hotSpots")||(S.scenes[a].hotSpots=[],a==t.scene&&(t.hotSpots=S.scenes[a].hotSpots)),S.scenes[a].hotSpots.push(e);else throw"Invalid scene ID!"}return(o===w||t.scene==o)&&(Zt(e),H&&L(e)),this},this.removeHotSpot=function(e,o){if(o===w||t.scene==o){if(!t.hotSpots)return!1;for(var a=0;a<t.hotSpots.length;a++)if(t.hotSpots[a].hasOwnProperty("id")&&t.hotSpots[a].id===e){for(var c=t.hotSpots[a].div;c.parentNode!=q;)c=c.parentNode;return q.removeChild(c),delete t.hotSpots[a].div,t.hotSpots.splice(a,1),!0}}else if(S.scenes.hasOwnProperty(o)){if(!S.scenes[o].hasOwnProperty("hotSpots"))return!1;for(a=0;a<S.scenes[o].hotSpots.length;a++)if(S.scenes[o].hotSpots[a].hasOwnProperty("id")&&S.scenes[o].hotSpots[a].id===e)return S.scenes[o].hotSpots.splice(a,1),!0}else return!1},this.resize=function(){M&&F()},this.isLoaded=function(){return H},this.isOrientationSupported=function(){return ie||!1},this.stopOrientation=function(){Y()},this.startOrientation=function(){ie&&W()},this.isOrientationActive=function(){return!!lt},this.on=function(e,o){return ot[e]=ot[e]||[],ot[e].push(o),this},this.off=function(e,o){if(!e)return ot={},this;if(o){var a=ot[e].indexOf(o);0<=a&&ot[e].splice(a,1),ot[e].length==0&&delete ot[e]}else delete ot[e];return this},this.destroy=function(){le=!0,clearTimeout(Jt),M&&M.destroy(),te&&(d.removeEventListener("mousemove",St,!1),d.removeEventListener("mouseup",Rt,!1),I.removeEventListener("mozfullscreenchange",l,!1),I.removeEventListener("webkitfullscreenchange",l,!1),I.removeEventListener("msfullscreenchange",l,!1),I.removeEventListener("fullscreenchange",l,!1),Z.removeEventListener("resize",F,!1),Z.removeEventListener("orientationchange",F,!1),I.removeEventListener("keydown",at,!1),I.removeEventListener("keyup",et,!1),I.removeEventListener("blur",ft,!1),d.removeEventListener("mouseleave",Rt,!1)),I.innerHTML="",I.classList.remove("pnlm-container")}}return{viewer:function(I,S){return new Ut(I,S)}}}(window,document);const Pe={class:"panorama-page"},_e={class:"panorama-wrapper"},Re={class:"viewer-header"},Te={class:"title"},Ce=fe({__name:"PanoramaViewer",setup(Z){const d=de(),w=be(),Ut=d.params.id,I=me("全景图片");function S(){w.push("/panorama")}async function wt(){try{const{data:Q}=await ge.get(`/panorama/${Ut}`);if(!Q.imagePath){ue.error("全景图数据不完整");return}const{protocol:tt,hostname:_t}=window.location,B=`${tt}//${_t}:8888${Q.imagePath}`;I.value=Q.title||"全景图片",window.pannellum.viewer("panoramaContainer",{type:"equirectangular",panorama:B,autoLoad:!0,showZoomCtrl:!0,showFullscreenCtrl:!0,mouseZoom:!0,draggable:!0})}catch(Q){console.error(Q),ue.error("加载全景图失败，请稍后重试")}}return pe(wt),(Q,tt)=>{const _t=ce("el-button"),B=ce("el-card");return ye(),ve("div",Pe,[re(we),Qt("div",_e,[re(B,{class:"panorama-card",shadow:"hover"},{default:he(()=>[Qt("div",Re,[re(_t,{type:"primary",icon:"el-icon-arrow-left",class:"back-button",onClick:S},{default:he(()=>tt[0]||(tt[0]=[xe(" 返回 ")])),_:1}),Qt("div",Te,Ee(I.value),1)]),tt[1]||(tt[1]=Qt("div",{id:"panoramaContainer",class:"pannellum-container"},null,-1))]),_:1})])])}}}),Ie=Me(Ce,[["__scopeId","data-v-94593830"]]);export{Ie as default};
