import{d as x,r as i,b as y,e as u,w as d,f as l,g as p,h as _,k as C,E as f,l as b,_ as h}from"./index-CI4pvarJ.js";const w={class:"quiz-import-page"},E={class:"import-action"},k=x({__name:"QuizImport",setup(I){const r=i([]),s=i(null),o=i(!1);function v(a,e){r.value=e.slice(-1),s.value=a.raw instanceof File?a.raw:null}function m(){r.value=[],s.value=null}async function g(){var e,n;if(!s.value)return;o.value=!0;const a=new FormData;a.append("file",s.value);try{const t=await C.post("/questions/import",a,{headers:{"Content-Type":"multipart/form-data"}});f.success(t.data.message||"导入成功"),m()}catch(t){console.error(t);const c=((n=(e=t.response)==null?void 0:e.data)==null?void 0:n.message)||"导入失败";f.error(c)}finally{o.value=!1}}return(a,e)=>{const n=p("el-upload"),t=p("el-button"),c=p("el-card");return b(),y("div",w,[u(c,{class:"import-card"},{default:d(()=>[e[2]||(e[2]=l("h2",{class:"card-title"},"Excel 导入题库",-1)),u(n,{class:"upload-area",drag:"",accept:".xlsx,.xls","auto-upload":!1,"list-type":"text","file-list":r.value,onChange:v,onRemove:m},{default:d(()=>e[0]||(e[0]=[l("i",{class:"el-icon-upload"},null,-1),l("div",{class:"el-upload__text"},[_(" 将 Excel 文件拖到此处，或"),l("em",null,"点击上传")],-1)])),_:1},8,["file-list"]),l("div",E,[u(t,{type:"primary",loading:o.value,disabled:!s.value||o.value,onClick:g},{default:d(()=>e[1]||(e[1]=[_(" 开始导入 ")])),_:1},8,["loading","disabled"])])]),_:1})])}}}),z=h(k,[["__scopeId","data-v-ae476e9b"]]);export{z as default};
